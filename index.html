<!DOCTYPE html>
<html lang="th">

<head>
  <title>ดรมฟ Online</title>
  <meta name="description" content="คำอธิบายเว็บไซต์" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="icon.png">

  <link rel="stylesheet" href="style.css">

  <script src="main.js" type="text/javascript"></script>

</head>

<body>
  <div class="container">
    <div class="page-header">
      <h2>โปรแกรม ดรมฟ Online</h2><p>ระดับเสียงกรมศิลปากร</p>
    </div>
    <select id="melody" onchange="changeMelody()">
      <option value="none">เลือกเพลงตัวอย่าง:
        <optgroup label="เพลงไทยเดิม">
          <option value="ลาวครวญ 2 ชั้น:
/----/----/->ซ-ม/รดรม/----/-ด-ร/-ด-ม/-รรร/
/---ซ/-ซซซ/ลซมซ/-ล-ดํ/---ดํ/-ดํดํดํ/-ซ-ม/รด-ร/">ลาวครวญ 2 ชั้น
          <option value="ลาวต่อนก 2 ชั้น:
/----/----/>รมซล/ซม-ซ/----/-ดํ-ล/-ซ-ม/รด-ร/
/---ม/---ร/---ดํ/มํรํดํล/-ซ-ด/-ร-ม/ซลซม/-ร-ด/">ลาวต่อนก 2 ชั้น
          <option value="ลาวจ้อย ชั้นเดียว(150):
/-ดรม/ซด-ร/-ดรม/ซล-ซ/-มซม/รดรม/รมซม/ซล-ซ/
/----/รมซล/--ดํล/ซม-ซ/-มรด/-ร-ม/รด-ร/-มรด/">ลาวจ้อย ชั้นเดียว
          <option value="แขกบรเทศ ชั้นเดียว(150):
/ดํลลล/ดํลลล/ดํซซซ/ดํลซม/ซมรด/ซดรม/ซลซม/ซมรด/
/มมซร/มรดล/ซมซล/ซลดํรํ/ซมรด/ซดรม/ซลซม/ซมรด/">แขกบรเทศ ชั้นเดียว
          <option value="ลาวเสี่ยงเทียน 2 ชั้น:
(ท่อน 1)
/----/----/->ลลล/ซลดํซ/---ฟ/-ม--/-ร-ซ/-ลซซ/
/----/----/-ลลล/ซลดํซ/---ฟ/-ม--/-ร-ซ/-ลซซ/
/-ลซม/ซรมซ/--ดํรํ/มํรํดํล/--ดํล/ซมซล/-ดํรํมํ/-รํ-ดํ/
/-มํ-รํ/-ดํ-มํ/--ดํรํ/มํรํดํล/--ดํล/ซมซล/-ดํรํมํ/-รํ-ดํ/
(ท่อน 2)
/----/----/ซลซม/ซรมซ/----/----/ซลซม/รด-ร/
/----/----/ซลซม/ซรมซ/----/----/ซลซม/รด-ร/
/-มํ-รํ/-ดํ-มํ/--ดํรํ/มํรํดํล/--ดํล/ซมซล/-ดํรํมํ/-รํ-ดํ/
/-มํ-รํ/-ดํ-มํ/--ดํรํ/มํรํดํล/--ดํล/ซมซล/-ดํรํมํ/-รํ-ดํ/">ลาวเสี่ยงเทียน 2 ชั้น
        </optgroup>
        <optgroup label="เพลงลูกทุ่ง">
          <option value="สาวสวนแตง:
/----/--->ดํ/--ลซ/ฟซลดํ/--ซล/ดํลซฟ/-ฟรฟ/ซลฟซ/
/----/ดํลซฟ/--ซล/ดํลซฟ/---ร/ฟซฟด/-รฟซ/ดํลซฟ/">สาวสวนแตง
          <option value="นิราศเวียงพิงค์:
/----/--->ด/--รม/ซลซล/--ดํม/ซลซล/--ซม/ซมรม/
/----/xมซด/--รม/รมลฺด/--รม/รมซด/--ซฺด/รมซม/
/----/-มซล/--ซม/รมดร/--มร/ดลฺซฺด/-ลฺซฺลฺ/ดลฺซฺลฺ/
/----/---ด/--รม/ซลซล/--ดํม/ซลซล/--ซม/ซมรม/
/----/xมซด/--รม/รมลฺด/--รม/รมซด/--ซฺด/รมซม/
/----/-มซล/--ซม/รมดร/--มร/ดลฺซฺด/-ลฺซฺลฺ/ดลฺซฺลฺ/---">นิราศเวียงพิงค์
        </optgroup>
    </select>

    <br>
    <br>
    <div class="rows">

      <div>
        <!-- <textarea id="thm1">testarea</textarea> -->
        <p><textarea type="text" id="thm" value="" class="" rows="3" cols="30" oninput="addRowTextarea();" onfocus="addRowTextarea();"></textarea></p>
        <button class="play" onmousedown="convert();rtttlPlay.play(document.querySelector('.rtttl').value)">เล่น</button>
        <button type="button" class="stop" aria-label="Play" onClick="rtttlPlay.stop()">หยุด</button>
      </div>

        <br>
        <div id="keyboard" style="display:block">
          <button name="button" value="ด" onclick="keyboardInput(this)">ด</button>
          <button name="button" value="ร" onclick="keyboardInput(this)">ร</button>
          <button name="button" value="ม" onclick="keyboardInput(this)">ม</button>
          <button name="button" value="ฟ" onclick="keyboardInput(this)">ฟ</button>
          <button name="button" value="ซ" onclick="keyboardInput(this)">ซ</button>
          <button name="button" value="ล" onclick="keyboardInput(this)">ล</button>
          <button name="button" value="ท" onclick="keyboardInput(this)">ท</button>
          <br>
          <button name="button" value="ดํ" onclick="keyboardInput(this)">ดํ</button>
          <button name="button" value="รํ" onclick="keyboardInput(this)">รํ</button>
          <button name="button" value="มํ" onclick="keyboardInput(this)">มํ</button>
          <button name="button" value="ฟํ" onclick="keyboardInput(this)">ฟํ</button>
          <button name="button" value="ซํ" onclick="keyboardInput(this)">ซํ</button>
          <button name="button" value="ลํ" onclick="keyboardInput(this)">ลํ</button>
          <button name="button" value="ทํ" onclick="keyboardInput(this)">ทํ</button>
          <br>
          <button name="button" value="ํ" onclick="keyboardInput(this)">สูง</button>
          <button name="button" value="ฺ" onclick="keyboardInput(this)">ต่ำ</button>
          <br>
          <button name="button" value="-" onclick="keyboardInput(this)">-</button>
          <button name="button" value="/" onclick="keyboardInput(this)">/</button>
          <button name="button" onclick="baskspace()"><--</button>
          <button name="button" value="
" onclick="keyboardInput(this)">Enter</button>
        </div>
        <script>
          //ฟังก์ชันคีย์บอร์ดสำหรับมือถือ
          //ใส่ค่าโน้ต/สัญญลักษณ์ที่ต้องการ
          let thmNote = document.getElementById('thm')
          function keyboardInput(note) {
            if (thmNote.value || !thmNote.value) {
              let noteVal = note.value
              thmNote.value += noteVal
              thmNote.focus()
            }
          }
          function baskspace() {
            thmNote.value = thmNote.value.slice(0, thmNote.value.length - 1)
            thmNote.focus()
          }
        </script>
        <!-- <details> -->
          <summary>แผงควบคุมเพิ่มเติม</summary>
          แปลงตัวโน้ต: <button class="btn btn-warning" onClick="changeText()" id="btn1">1234</button>
          <button type="button" class="btn btn-primary" aria-label="Play" onClick="getSongHash()">สร้างลิงก์</button>
          </button>
          <br>
          ชนิดของคลื่น:<select id="type">
            <option value="sine">Sine</option>
            <option value="square">Square</option>
            <option value="sawtooth">Sawtooth</option>
            <option value="triangle">Triangle</option>
          </select>
          ช่วงทบเสียง:<select id="octave">
            <option value="4">+2</option>
            <option value="2">+1</option>
            <option value="1" selected="selected">0</option>
            <option value="-2">-1</option>
            <option value="-4">-2</option>
          </select>
          <br>
          <input type="file" onchange="readFile(this)"></input><button class="btn btn-danger" type="button" value="save" onclick="saveTextAsFile()"><span>บันทึกไฟล์</span>
        <br>

      </div>
      <div style="display:none">
        <h4>RTTTL</h4>
        <p><textarea id="rtttl" name="rtttl" class="rtttl" rows="3" cols="100"></textarea></p>
      </div>
    </div>

    </p>
  </div>
  </div>
  <hr />
  <center>
    <!-- <a href="about.html">คำอธิบาย</a>
    <br>
    <a href="https://github.com/warut92/rtttl-th/">GitHub</a> -->
  </center>
  <script>
    function addRowTextarea() {
      var lines = document.querySelector("textarea").value.split(/\r\n|\r|\n/).length;
      document.getElementById("thm").rows = lines;
    }
    //
    // // localstorage in textarea https://jsfiddle.net/9KBWF/
    // var editor = document.querySelector("#thm");
    // if (window.localStorage["localNote"]) {
    //     editor.value = window.localStorage["localNote"];
    // }
    //
    // editor.addEventListener("keyup", function() {
    //     window.localStorage["localNote"] = editor.value;
    // });

    //สร้างลิงก์สำหรับการแชร์
    function getSongHash() {
      //สร้างตัวแปรสำหรับการสร้างลิงก์ใหม่ โดยการกดปุ่มเพื่อรันฟังก์ชัน
      let song = document.getElementById('thm').value;
      song = song.replace(/\n/g, "%0A")
      location.hash = song
      // document.getElementById('hashlink').innerHTML = location.hash
      // console.log('LOCATION.HASH string', location.hash)
      alert('สร้างลิงก์แล้ว ท่านสามารถคัดลองลิงก์ที่ช่อง url ของเบราว์เซอร์');
    }

    function loadShareSong() {
      //โหลดเพลง หากลิงก์มีข้อมูลสำหรับโน้ต ให้ดำเนินการรับค่ามาใส่ใน textarea
      if (location.hash) {
        // console.log("do it!");
        let shareSong = location.hash
        // console.log('SHARESONG', shareSong)
        let decodeSongSlice = shareSong.slice(1)
        document.getElementById('thm').innerHTML = decodeURI(decodeSongSlice)
      }
    }
    loadShareSong()
  </script>

  <script src="rtttl/index.umd.js"></script>

</body>

</html>
